sudo: required
dist: trusty

language: c

install:
  # Make sure apt is up to date.
  - "travis_retry sudo apt-get update"
  # Travis is on 64bit and we need some 32bit compatibility libs installed
  - "travis_retry sudo dpkg --add-architecture i386"
  - "travis_retry sudo apt-get -qq install libc6:i386"
  # Install all adtools related stuff we need
  - wget https://dl.bintray.com/jens-maus/adtools/adtools-utils.tar.bz2
  - wget https://dl.bintray.com/jens-maus/adtools/adtools-m68k-amigaos.tar.bz2
  - wget https://dl.bintray.com/jens-maus/adtools/adtools-ppc-amigaos.tar.bz2
  - wget https://dl.bintray.com/jens-maus/adtools/adtools-ppc-morphos.tar.bz2
  - sudo tar xf adtools-utils.tar.bz2 -C /
  - sudo tar xf adtools-m68k-amigaos.tar.bz2 -C /
  - sudo tar xf adtools-ppc-amigaos.tar.bz2 -C /
  - sudo tar xf adtools-ppc-morphos.tar.bz2 -C /

before_script:
  - export PATH=/usr/local/amiga/bin:/opt/m68k-amigaos/bin:/opt/ppc-amigaos/bin:/opt/ppc-morphos/bin:${PATH}

script:
  #- make OS=os4 -j1
  - make OS=os3 -j1
  - make OS=mos -j1
  - ldd /opt/m68k-amigaos/bin/m68k-amigaos-gcc
