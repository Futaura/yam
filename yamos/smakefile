# Programs
CC = sc
RM = delete

# Files
GST = YAM.gst
OBJS= YAM.o YAM_AB.o YAM_CL.o YAM_CO.o YAM_COg.o YAM_COs.o YAM_DI.o YAM_EA.o \
      YAM_ER.o YAM_FI.o YAM_FO.o YAM_MA.o YAM_MAf.o YAM_MI.o YAM_RE.o YAM_TR.o YAM_US.o \
      YAM_UT.o YAM_WR.o YAM_loc.o YAM_rexx.o YAM_rexx_rxcl.o YAM_rexx_rxif.o

# Compiler flags
YAMVERSION = "2.3-dev"
YAMDATE	   = "20.11.00"
#OPTFLAGS   = OPT OPTCOMPLEXITY=5 OPTDEPTH=3 OPTINLOCAL
OPTFLAGS   = NOOPT
DEBUG	   = DEF DEBUG

CFLAGS = NOLINK GST=$(GST) DEF YAMVER=$(YAMVERSION) DEF YAMDATE=$(YAMDATE) $(DEBUG)


# Default rules
.c.o:
	$(CC) $(CFLAGS) $(OPTFLAGS) $*.c


# Targets & dependencies
all:	$(GST) YAM

clean:
	$(RM) YAM *.o $(GST)

YAM:	$(OBJS)
	slink <with <
	TO YAM
	FROM lib:c.o $(OBJS)
	LIB lib:sc.lib lib:amiga.lib lib:debug.lib lib:md5.lib lib:wbpath.o lib:NewReadArgs.o 
	<

YAM.h: YAM.h.in
   copy YAM.h.in YAM.h

YAM.o:     YAM.c     YAM.h YAM_loc.h
YAM_AB.o:  YAM_AB.c  YAM.h YAM_loc.h
YAM_CL.o:  YAM_CL.c  YAM.h YAM_loc.h
YAM_CO.o:  YAM_CO.c  YAM.h YAM_loc.h
YAM_COg.o: YAM_COg.c YAM.h YAM_loc.h
YAM_COs.o: YAM_COs.c YAM.h YAM_loc.h
YAM_DI.o:  YAM_DI.c  YAM.h YAM_loc.h
YAM_EA.o:  YAM_EA.c  YAM.h YAM_loc.h
YAM_ER.o:  YAM_ER.c  YAM.h YAM_loc.h
YAM_FI.o:  YAM_FI.c  YAM.h YAM_loc.h
YAM_FO.o:  YAM_FO.c  YAM.h YAM_loc.h
		$(CC) $(CFLAGS) NOOPT $*.c		# doesn't compile with optimization :-(

YAM_MA.o:  YAM_MA.c  YAM.h YAM_loc.h
		$(CC) $(CFLAGS) NOOPT $*.c		# doesn't compile with optimization :-(

YAM_MAf.o: YAM_MAf.c YAM.h YAM_loc.h
YAM_MI.o:  YAM_MI.c  YAM.h YAM_loc.h
YAM_RE.o:  YAM_RE.c  YAM.h YAM_loc.h
YAM_TR.o:  YAM_TR.c  YAM.h YAM_loc.h
YAM_US.o:  YAM_US.c  YAM.h YAM_loc.h
YAM_UT.o:  YAM_UT.c  YAM.h YAM_loc.h
YAM_WR.o:  YAM_WR.c  YAM.h YAM_loc.h
YAM_loc.o: YAM_loc.c
YAM_rexx.o     : YAM_rexx.c YAM_rexx.h 
YAM_rexx_rxcl.o: YAM_rexx_rxcl.c YAM_rexx.h
YAM_rexx_rxif.o: YAM_rexx_rxif.c YAM_rexx.h YAM.h YAM_loc.h 

YAM_loc.c: YAM.cd
   flexcat YAM.cd YAM_loc.h=C_h.sd YAM_loc.c=C_c.sd

deutsch.catalog: deutsch.ct
   flexcat YAM.cd deutsch.ct CATALOG LOCALE:catalogs/deutsch/YAM.catalog FLUSH

$(GST): headers.h
   sc headers.h mkgst $(GST) IGNORE=105
